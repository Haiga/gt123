2021-07-06 13:11:04,178 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-06 13:11:04,179 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskListnetLoss', args={}),
 'lr_scheduler': NameArgsConfig(name='StepLR', args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-06 13:11:04,180 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-06 13:11:04,192 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-06 13:11:04,192 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-06 13:11:05,580 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-06 13:11:05,589 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-06 13:11:05,590 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-06 13:11:05,591 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-06 13:11:05,591 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-06 13:11:06,041 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-06 13:11:06,044 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-06 13:11:06,044 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-06 13:11:06,045 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-06 13:11:06,045 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-06 13:11:06,045 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-06 13:11:06,496 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-06 13:11:06,499 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-06 13:11:06,500 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-06 13:11:06,500 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-06 13:11:06,500 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-06 13:11:06,502 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-06 13:11:06,502 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-06 13:11:06,512 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-06 13:11:06,512 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-06 13:12:57,223 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.0794471157687252 Val loss: 0.07747993128137955 Train ndcg_5 0.216005340218544 Train ndcg_10 0.25096189975738525 Train lndcg_5 0.2309044450521469 Train lndcg_10 0.26040613651275635 Train georisk_10 0.3333992660045624 Val ndcg_5 0.24104638397693634 Val ndcg_10 0.2810143232345581 Val lndcg_5 0.25115761160850525 Val lndcg_10 0.28947553038597107 Val georisk_10 0.34349703788757324
2021-07-06 13:12:57,223 - allrank.utils.ltr_logging - INFO - Current:0.2810143232345581 Best:0.0
2021-07-06 13:12:59,051 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.2527373339730599, 'ndcg_10': 0.2823333672755543, 'lndcg_5': 0.2628197257135218, 'lndcg_10': 0.2909013007363113} 
2021-07-06 13:12:59,051 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-06 13:14:48,443 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.07942356818310747 Val loss: 0.07746287784745208 Train ndcg_5 0.21157300472259521 Train ndcg_10 0.24796611070632935 Train lndcg_5 0.228515625 Train lndcg_10 0.2602290213108063 Train georisk_10 0.33469927310943604 Val ndcg_5 0.27547207474708557 Val ndcg_10 0.307637482881546 Val lndcg_5 0.2863731384277344 Val lndcg_10 0.3167945146560669 Val georisk_10 0.3583698272705078
2021-07-06 13:14:48,444 - allrank.utils.ltr_logging - INFO - Current:0.307637482881546 Best:0.2810143232345581
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.28070869944302507, 'ndcg_10': 0.3101884300849117, 'lndcg_5': 0.2901912581751357, 'lndcg_10': 0.3184548007002777} 
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.0794471157687252, 0.07942356818310747]
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.07747993128137955, 0.07746287784745208]
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.21600534, 'ndcg_10': 0.2509619, 'lndcg_5': 0.23090445, 'lndcg_10': 0.26040614, 'georisk_10': 0.33339927}, {'ndcg_5': 0.211573, 'ndcg_10': 0.24796611, 'lndcg_5': 0.22851562, 'lndcg_10': 0.26022902, 'georisk_10': 0.33469927}]
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.24104638, 'ndcg_10': 0.28101432, 'lndcg_5': 0.2511576, 'lndcg_10': 0.28947553, 'georisk_10': 0.34349704}, {'ndcg_5': 0.27547207, 'ndcg_10': 0.30763748, 'lndcg_5': 0.28637314, 'lndcg_10': 0.3167945, 'georisk_10': 0.35836983}]
2021-07-06 13:14:50,764 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.2527373339730599, 'ndcg_10': 0.2823333672755543, 'lndcg_5': 0.2628197257135218, 'lndcg_10': 0.2909013007363113}, {'ndcg_5': 0.28070869944302507, 'ndcg_10': 0.3101884300849117, 'lndcg_5': 0.2901912581751357, 'lndcg_10': 0.3184548007002777}]
2021-07-06 14:04:31,884 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-06 14:04:45,713 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-06 14:04:45,714 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskListnetLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-06 14:04:45,714 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-06 14:04:45,726 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-06 14:04:45,726 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-06 14:04:47,060 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-06 14:04:47,071 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-06 14:04:47,071 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-06 14:04:47,073 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-06 14:04:47,073 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-06 14:04:47,529 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-06 14:04:47,532 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-06 14:04:47,532 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-06 14:04:47,533 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-06 14:04:47,533 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-06 14:04:47,533 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-06 14:04:47,970 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-06 14:04:47,973 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-06 14:04:47,974 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-06 14:04:47,974 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-06 14:04:47,974 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-06 14:04:47,975 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-06 14:04:47,976 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-06 14:04:47,984 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-06 14:04:47,984 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-06 14:06:38,065 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.0794471157687252 Val loss: 0.07747993128137955 Train ndcg_5 0.216005340218544 Train ndcg_10 0.25096189975738525 Train lndcg_5 0.2309044450521469 Train lndcg_10 0.26040613651275635 Train georisk_10 0.3333992660045624 Val ndcg_5 0.24104638397693634 Val ndcg_10 0.2810143232345581 Val lndcg_5 0.25115761160850525 Val lndcg_10 0.28947553038597107 Val georisk_10 0.34349703788757324
2021-07-06 14:06:38,066 - allrank.utils.ltr_logging - INFO - Current:0.2810143232345581 Best:0.0
2021-07-06 14:06:39,989 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.2527373339730599, 'ndcg_10': 0.2823333672755543, 'lndcg_5': 0.2628197257135218, 'lndcg_10': 0.2909013007363113} 
2021-07-06 14:06:39,989 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-06 14:08:26,335 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.07942356818310747 Val loss: 0.07746287784745208 Train ndcg_5 0.21157300472259521 Train ndcg_10 0.24796611070632935 Train lndcg_5 0.228515625 Train lndcg_10 0.2602290213108063 Train georisk_10 0.33469927310943604 Val ndcg_5 0.27547207474708557 Val ndcg_10 0.307637482881546 Val lndcg_5 0.2863731384277344 Val lndcg_10 0.3167945146560669 Val georisk_10 0.3583698272705078
2021-07-06 14:08:26,336 - allrank.utils.ltr_logging - INFO - Current:0.307637482881546 Best:0.2810143232345581
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.28070869944302507, 'ndcg_10': 0.3101884300849117, 'lndcg_5': 0.2901912581751357, 'lndcg_10': 0.3184548007002777} 
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.0794471157687252, 0.07942356818310747]
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.07747993128137955, 0.07746287784745208]
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.21600534, 'ndcg_10': 0.2509619, 'lndcg_5': 0.23090445, 'lndcg_10': 0.26040614, 'georisk_10': 0.33339927}, {'ndcg_5': 0.211573, 'ndcg_10': 0.24796611, 'lndcg_5': 0.22851562, 'lndcg_10': 0.26022902, 'georisk_10': 0.33469927}]
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.24104638, 'ndcg_10': 0.28101432, 'lndcg_5': 0.2511576, 'lndcg_10': 0.28947553, 'georisk_10': 0.34349704}, {'ndcg_5': 0.27547207, 'ndcg_10': 0.30763748, 'lndcg_5': 0.28637314, 'lndcg_10': 0.3167945, 'georisk_10': 0.35836983}]
2021-07-06 14:08:28,168 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.2527373339730599, 'ndcg_10': 0.2823333672755543, 'lndcg_5': 0.2628197257135218, 'lndcg_10': 0.2909013007363113}, {'ndcg_5': 0.28070869944302507, 'ndcg_10': 0.3101884300849117, 'lndcg_5': 0.2901912581751357, 'lndcg_10': 0.3184548007002777}]
2021-07-08 12:38:41,802 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-08 12:38:41,817 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-08 12:38:41,817 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-08 12:38:41,833 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-08 12:38:41,833 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-08 12:38:43,327 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-08 12:38:43,336 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-08 12:38:43,336 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-08 12:38:43,338 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-08 12:38:43,338 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-08 12:38:43,795 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-08 12:38:43,798 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-08 12:38:43,799 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-08 12:38:43,799 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-08 12:38:43,799 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-08 12:38:43,799 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-08 12:38:44,241 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-08 12:38:44,244 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-08 12:38:44,244 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-08 12:38:44,245 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-08 12:38:44,245 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-08 12:38:44,507 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-08 12:38:44,507 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-08 12:38:44,839 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-08 12:38:44,839 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:39:30,984 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.7232329078831854 Val loss: 3.7008080334789986 Train ndcg_5 0.21066412329673767 Train ndcg_10 0.2410522997379303 Train lndcg_5 0.22210626304149628 Train lndcg_10 0.251394659280777 Train georisk_10 0.32329586148262024 Val ndcg_5 0.16154715418815613 Val ndcg_10 0.20992103219032288 Val lndcg_5 0.17027965188026428 Val lndcg_10 0.21717941761016846 Val georisk_10 0.3010061979293823
2021-07-08 12:39:30,984 - allrank.utils.ltr_logging - INFO - Current:0.20992103219032288 Best:0.0
2021-07-08 12:39:32,967 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023} 
2021-07-08 12:39:32,967 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:40:19,905 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.7154795202182105 Val loss: 3.7004236042675367 Train ndcg_5 0.19778801500797272 Train ndcg_10 0.23153747618198395 Train lndcg_5 0.21067458391189575 Train lndcg_10 0.24170485138893127 Train georisk_10 0.32224270701408386 Val ndcg_5 0.18056350946426392 Val ndcg_10 0.22412118315696716 Val lndcg_5 0.18936535716056824 Val lndcg_10 0.2318718135356903 Val georisk_10 0.30955588817596436
2021-07-08 12:40:19,906 - allrank.utils.ltr_logging - INFO - Current:0.22412118315696716 Best:0.20992103219032288
2021-07-08 12:40:21,862 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19368698292167447, 'ndcg_10': 0.22311418606147126, 'lndcg_5': 0.20328141579307246, 'lndcg_10': 0.23176289793410282} 
2021-07-08 12:40:21,862 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:41:04,855 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 3.71324098731447 Val loss: 3.7003454796332527 Train ndcg_5 0.20586052536964417 Train ndcg_10 0.23989084362983704 Train lndcg_5 0.21941174566745758 Train lndcg_10 0.24724207818508148 Train georisk_10 0.33243855834007263 Val ndcg_5 0.19322659075260162 Val ndcg_10 0.23735201358795166 Val lndcg_5 0.20221106708049774 Val lndcg_10 0.24506619572639465 Val georisk_10 0.3173794746398926
2021-07-08 12:41:04,857 - allrank.utils.ltr_logging - INFO - Current:0.23735201358795166 Best:0.22412118315696716
2021-07-08 12:41:07,008 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.20540354935358268, 'ndcg_10': 0.23331604428472616, 'lndcg_5': 0.21467530032294033, 'lndcg_10': 0.24157269609808615} 
2021-07-08 12:41:07,008 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:41:50,109 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 3.712856604989651 Val loss: 3.7003215449397895 Train ndcg_5 0.2136794626712799 Train ndcg_10 0.24475808441638947 Train lndcg_5 0.21655192971229553 Train lndcg_10 0.25523680448532104 Train georisk_10 0.32659807801246643 Val ndcg_5 0.19959670305252075 Val ndcg_10 0.24353335797786713 Val lndcg_5 0.2087593674659729 Val lndcg_10 0.2512523829936981 Val georisk_10 0.3209712505340576
2021-07-08 12:41:50,110 - allrank.utils.ltr_logging - INFO - Current:0.24353335797786713 Best:0.23735201358795166
2021-07-08 12:41:51,937 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.20969451320338198, 'ndcg_10': 0.24004915262949034, 'lndcg_5': 0.2192546744351204, 'lndcg_10': 0.2484450324940573} 
2021-07-08 12:41:51,937 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:42:38,459 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 3.712491324517579 Val loss: 3.700311261995704 Train ndcg_5 0.21295489370822906 Train ndcg_10 0.24739427864551544 Train lndcg_5 0.23177899420261383 Train lndcg_10 0.25825878977775574 Train georisk_10 0.32455241680145264 Val ndcg_5 0.20673294365406036 Val ndcg_10 0.24893558025360107 Val lndcg_5 0.21596169471740723 Val lndcg_10 0.2561887204647064 Val georisk_10 0.3230327367782593
2021-07-08 12:42:38,459 - allrank.utils.ltr_logging - INFO - Current:0.24893558025360107 Best:0.24353335797786713
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.21374070893331631, 'ndcg_10': 0.2465511170780679, 'lndcg_5': 0.2233594195728404, 'lndcg_10': 0.25477821684109514} 
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.7232329078831854, 3.7154795202182105, 3.71324098731447, 3.712856604989651, 3.712491324517579]
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.7008080334789986, 3.7004236042675367, 3.7003454796332527, 3.7003215449397895, 3.700311261995704]
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.21066412, 'ndcg_10': 0.2410523, 'lndcg_5': 0.22210626, 'lndcg_10': 0.25139466, 'georisk_10': 0.32329586}, {'ndcg_5': 0.19778802, 'ndcg_10': 0.23153748, 'lndcg_5': 0.21067458, 'lndcg_10': 0.24170485, 'georisk_10': 0.3222427}, {'ndcg_5': 0.20586053, 'ndcg_10': 0.23989084, 'lndcg_5': 0.21941175, 'lndcg_10': 0.24724208, 'georisk_10': 0.33243856}, {'ndcg_5': 0.21367946, 'ndcg_10': 0.24475808, 'lndcg_5': 0.21655193, 'lndcg_10': 0.2552368, 'georisk_10': 0.32659808}, {'ndcg_5': 0.2129549, 'ndcg_10': 0.24739428, 'lndcg_5': 0.231779, 'lndcg_10': 0.2582588, 'georisk_10': 0.32455242}]
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.16154715, 'ndcg_10': 0.20992103, 'lndcg_5': 0.17027965, 'lndcg_10': 0.21717942, 'georisk_10': 0.3010062}, {'ndcg_5': 0.18056351, 'ndcg_10': 0.22412118, 'lndcg_5': 0.18936536, 'lndcg_10': 0.23187181, 'georisk_10': 0.3095559}, {'ndcg_5': 0.19322659, 'ndcg_10': 0.23735201, 'lndcg_5': 0.20221107, 'lndcg_10': 0.2450662, 'georisk_10': 0.31737947}, {'ndcg_5': 0.1995967, 'ndcg_10': 0.24353336, 'lndcg_5': 0.20875937, 'lndcg_10': 0.25125238, 'georisk_10': 0.32097125}, {'ndcg_5': 0.20673294, 'ndcg_10': 0.24893558, 'lndcg_5': 0.2159617, 'lndcg_10': 0.25618872, 'georisk_10': 0.32303274}]
2021-07-08 12:42:40,302 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023}, {'ndcg_5': 0.19368698292167447, 'ndcg_10': 0.22311418606147126, 'lndcg_5': 0.20328141579307246, 'lndcg_10': 0.23176289793410282}, {'ndcg_5': 0.20540354935358268, 'ndcg_10': 0.23331604428472616, 'lndcg_5': 0.21467530032294033, 'lndcg_10': 0.24157269609808615}, {'ndcg_5': 0.20969451320338198, 'ndcg_10': 0.24004915262949034, 'lndcg_5': 0.2192546744351204, 'lndcg_10': 0.2484450324940573}, {'ndcg_5': 0.21374070893331631, 'ndcg_10': 0.2465511170780679, 'lndcg_5': 0.2233594195728404, 'lndcg_10': 0.25477821684109514}]
2021-07-08 12:48:38,300 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-08 12:48:38,301 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-08 12:48:38,301 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-08 12:48:38,317 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-08 12:48:38,317 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-08 12:48:39,509 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-08 12:48:39,518 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-08 12:48:39,518 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-08 12:48:39,520 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-08 12:48:39,520 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-08 12:48:39,903 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-08 12:48:39,906 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-08 12:48:39,906 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-08 12:48:39,907 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-08 12:48:39,907 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-08 12:48:39,907 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-08 12:48:40,292 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-08 12:48:40,295 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-08 12:48:40,295 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-08 12:48:40,296 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-08 12:48:40,296 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-08 12:48:40,297 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-08 12:48:40,297 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-08 12:48:40,397 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-08 12:48:40,397 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:48:42,559 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.232098088925786, 'ndcg_10': 0.26064886247471425, 'lndcg_5': 0.2420535739960416, 'lndcg_10': 0.26943187619306136} 
2021-07-08 12:48:42,559 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:48:44,654 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.24431491559644017, 'ndcg_10': 0.2655638196835308, 'lndcg_5': 0.2553892837910964, 'lndcg_10': 0.2754141926913822} 
2021-07-08 12:48:44,655 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:48:46,819 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.23095348362656273, 'ndcg_10': 0.26450881566104245, 'lndcg_5': 0.24235950820993996, 'lndcg_10': 0.27421096926680616} 
2021-07-08 12:48:46,819 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:48:49,065 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.22595900856785905, 'ndcg_10': 0.24520571215749462, 'lndcg_5': 0.23724496291701294, 'lndcg_10': 0.2552659691049389} 
2021-07-08 12:48:49,066 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.23964614856125613, 'ndcg_10': 0.2692138709820296, 'lndcg_5': 0.25085930004786583, 'lndcg_10': 0.2785572491616332} 
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[]
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[]
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[]
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[]
2021-07-08 12:48:51,233 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.232098088925786, 'ndcg_10': 0.26064886247471425, 'lndcg_5': 0.2420535739960416, 'lndcg_10': 0.26943187619306136}, {'ndcg_5': 0.24431491559644017, 'ndcg_10': 0.2655638196835308, 'lndcg_5': 0.2553892837910964, 'lndcg_10': 0.2754141926913822}, {'ndcg_5': 0.23095348362656273, 'ndcg_10': 0.26450881566104245, 'lndcg_5': 0.24235950820993996, 'lndcg_10': 0.27421096926680616}, {'ndcg_5': 0.22595900856785905, 'ndcg_10': 0.24520571215749462, 'lndcg_5': 0.23724496291701294, 'lndcg_10': 0.2552659691049389}, {'ndcg_5': 0.23964614856125613, 'ndcg_10': 0.2692138709820296, 'lndcg_5': 0.25085930004786583, 'lndcg_10': 0.2785572491616332}]
2021-07-09 15:18:06,005 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-09 15:18:06,018 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-09 15:18:06,018 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-09 15:18:06,034 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-09 15:18:06,034 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-09 15:18:07,354 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-09 15:18:07,364 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-09 15:18:07,364 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-09 15:18:07,366 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-09 15:18:07,366 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-09 15:18:07,766 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-09 15:18:07,769 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-09 15:18:07,785 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-09 15:18:07,786 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-09 15:18:07,786 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-09 15:18:07,786 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-09 15:18:08,197 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-09 15:18:08,201 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-09 15:18:08,201 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-09 15:18:08,201 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-09 15:18:08,201 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-09 15:18:08,463 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-09 15:18:08,463 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-09 15:18:08,795 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-09 15:18:08,795 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:18:37,988 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.723869542456658 Val loss: 3.700803136403582 Train ndcg_5 0.21289320290088654 Train ndcg_10 0.24330008029937744 Train lndcg_5 0.21093624830245972 Train lndcg_10 0.24240969121456146 Train georisk_10 0.3285534083843231 Val ndcg_5 0.15921840071678162 Val ndcg_10 0.20799921452999115 Val lndcg_5 0.1678084284067154 Val lndcg_10 0.21525375545024872 Val georisk_10 0.3001590967178345
2021-07-09 15:18:37,989 - allrank.utils.ltr_logging - INFO - Current:0.20799921452999115 Best:0.0
2021-07-09 15:18:40,504 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422} 
2021-07-09 15:18:40,504 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:19:09,135 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.71550670954799 Val loss: 3.7004258238812113 Train ndcg_5 0.20789304375648499 Train ndcg_10 0.23540480434894562 Train lndcg_5 0.2123473882675171 Train lndcg_10 0.24379776418209076 Train georisk_10 0.32824644446372986 Val ndcg_5 0.1790321320295334 Val ndcg_10 0.22297073900699615 Val lndcg_5 0.18775561451911926 Val lndcg_10 0.23058323562145233 Val georisk_10 0.3087117373943329
2021-07-09 15:19:09,135 - allrank.utils.ltr_logging - INFO - Current:0.22297073900699615 Best:0.20799921452999115
2021-07-09 15:19:11,172 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329} 
2021-07-09 15:19:11,172 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.723869542456658, 3.71550670954799]
2021-07-09 15:19:11,172 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.700803136403582, 3.7004258238812113]
2021-07-09 15:19:11,172 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.2128932, 'ndcg_10': 0.24330008, 'lndcg_5': 0.21093625, 'lndcg_10': 0.24240969, 'georisk_10': 0.3285534}, {'ndcg_5': 0.20789304, 'ndcg_10': 0.2354048, 'lndcg_5': 0.21234739, 'lndcg_10': 0.24379776, 'georisk_10': 0.32824644}]
2021-07-09 15:19:11,172 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.1592184, 'ndcg_10': 0.20799921, 'lndcg_5': 0.16780843, 'lndcg_10': 0.21525376, 'georisk_10': 0.3001591}, {'ndcg_5': 0.17903213, 'ndcg_10': 0.22297074, 'lndcg_5': 0.18775561, 'lndcg_10': 0.23058324, 'georisk_10': 0.30871174}]
2021-07-09 15:19:11,173 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422}, {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329}]
2021-07-09 15:19:16,152 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-09 15:19:16,153 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-09 15:19:16,153 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-09 15:19:16,172 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-09 15:19:16,172 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-09 15:19:17,439 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-09 15:19:17,449 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-09 15:19:17,449 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-09 15:19:17,452 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-09 15:19:17,452 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-09 15:19:17,850 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-09 15:19:17,854 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-09 15:19:17,854 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-09 15:19:17,855 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-09 15:19:17,855 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-09 15:19:17,855 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-09 15:19:18,252 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-09 15:19:18,256 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-09 15:19:18,256 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-09 15:19:18,257 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-09 15:19:18,257 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-09 15:19:18,258 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-09 15:19:18,259 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-09 15:19:18,265 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-09 15:19:18,265 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:19:44,338 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.723869542456658 Val loss: 3.700803136403582 Train ndcg_5 0.21289320290088654 Train ndcg_10 0.24330008029937744 Train lndcg_5 0.21093624830245972 Train lndcg_10 0.24240969121456146 Train georisk_10 0.3285534083843231 Val ndcg_5 0.15921840071678162 Val ndcg_10 0.20799921452999115 Val lndcg_5 0.1678084284067154 Val lndcg_10 0.21525375545024872 Val georisk_10 0.3001590967178345
2021-07-09 15:19:44,338 - allrank.utils.ltr_logging - INFO - Current:0.20799921452999115 Best:0.0
2021-07-09 15:19:46,279 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422} 
2021-07-09 15:19:46,279 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:20:11,925 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.71550670954799 Val loss: 3.7004258238812113 Train ndcg_5 0.20789304375648499 Train ndcg_10 0.23540480434894562 Train lndcg_5 0.2123473882675171 Train lndcg_10 0.24379776418209076 Train georisk_10 0.32824644446372986 Val ndcg_5 0.1790321320295334 Val ndcg_10 0.22297073900699615 Val lndcg_5 0.18775561451911926 Val lndcg_10 0.23058323562145233 Val georisk_10 0.3087117373943329
2021-07-09 15:20:11,926 - allrank.utils.ltr_logging - INFO - Current:0.22297073900699615 Best:0.20799921452999115
2021-07-09 15:20:13,851 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329} 
2021-07-09 15:20:13,852 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.723869542456658, 3.71550670954799]
2021-07-09 15:20:13,852 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.700803136403582, 3.7004258238812113]
2021-07-09 15:20:13,852 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.2128932, 'ndcg_10': 0.24330008, 'lndcg_5': 0.21093625, 'lndcg_10': 0.24240969, 'georisk_10': 0.3285534}, {'ndcg_5': 0.20789304, 'ndcg_10': 0.2354048, 'lndcg_5': 0.21234739, 'lndcg_10': 0.24379776, 'georisk_10': 0.32824644}]
2021-07-09 15:20:13,852 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.1592184, 'ndcg_10': 0.20799921, 'lndcg_5': 0.16780843, 'lndcg_10': 0.21525376, 'georisk_10': 0.3001591}, {'ndcg_5': 0.17903213, 'ndcg_10': 0.22297074, 'lndcg_5': 0.18775561, 'lndcg_10': 0.23058324, 'georisk_10': 0.30871174}]
2021-07-09 15:20:13,852 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422}, {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329}]
2021-07-09 15:20:20,565 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-09 15:20:20,565 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-09 15:20:20,566 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-09 15:20:20,577 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-09 15:20:20,577 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-09 15:20:21,843 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-09 15:20:21,853 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-09 15:20:21,853 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-09 15:20:21,855 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-09 15:20:21,856 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-09 15:20:22,276 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-09 15:20:22,281 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-09 15:20:22,282 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-09 15:20:22,282 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-09 15:20:22,282 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-09 15:20:22,283 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-09 15:20:22,714 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-09 15:20:22,718 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-09 15:20:22,718 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-09 15:20:22,719 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-09 15:20:22,719 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-09 15:20:22,721 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-09 15:20:22,721 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-09 15:20:22,727 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-09 15:20:22,727 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:20:52,521 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.723869542456658 Val loss: 3.700803136403582 Train ndcg_5 0.21289320290088654 Train ndcg_10 0.24330008029937744 Train lndcg_5 0.21093624830245972 Train lndcg_10 0.24240969121456146 Train georisk_10 0.3285534083843231 Val ndcg_5 0.15921840071678162 Val ndcg_10 0.20799921452999115 Val lndcg_5 0.1678084284067154 Val lndcg_10 0.21525375545024872 Val georisk_10 0.3001590967178345
2021-07-09 15:20:52,522 - allrank.utils.ltr_logging - INFO - Current:0.20799921452999115 Best:0.0
2021-07-09 15:20:54,376 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422} 
2021-07-09 15:20:54,376 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-09 15:21:20,300 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.71550670954799 Val loss: 3.7004258238812113 Train ndcg_5 0.20789304375648499 Train ndcg_10 0.23540480434894562 Train lndcg_5 0.2123473882675171 Train lndcg_10 0.24379776418209076 Train georisk_10 0.32824644446372986 Val ndcg_5 0.1790321320295334 Val ndcg_10 0.22297073900699615 Val lndcg_5 0.18775561451911926 Val lndcg_10 0.23058323562145233 Val georisk_10 0.3087117373943329
2021-07-09 15:21:20,302 - allrank.utils.ltr_logging - INFO - Current:0.22297073900699615 Best:0.20799921452999115
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329} 
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.723869542456658, 3.71550670954799]
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.700803136403582, 3.7004258238812113]
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.2128932, 'ndcg_10': 0.24330008, 'lndcg_5': 0.21093625, 'lndcg_10': 0.24240969, 'georisk_10': 0.3285534}, {'ndcg_5': 0.20789304, 'ndcg_10': 0.2354048, 'lndcg_5': 0.21234739, 'lndcg_10': 0.24379776, 'georisk_10': 0.32824644}]
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.1592184, 'ndcg_10': 0.20799921, 'lndcg_5': 0.16780843, 'lndcg_10': 0.21525376, 'georisk_10': 0.3001591}, {'ndcg_5': 0.17903213, 'ndcg_10': 0.22297074, 'lndcg_5': 0.18775561, 'lndcg_10': 0.23058324, 'georisk_10': 0.30871174}]
2021-07-09 15:21:22,304 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.18100528838006805, 'ndcg_10': 0.2095740338650421, 'lndcg_5': 0.19007431664558774, 'lndcg_10': 0.21797090716973422}, {'ndcg_5': 0.19008497785908124, 'ndcg_10': 0.22039731015119482, 'lndcg_5': 0.1993594850473198, 'lndcg_10': 0.2290401630391329}]
2021-07-12 14:24:59,100 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-12 14:24:59,131 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'fndcg': [10,
                                   10],
                         'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-12 14:24:59,131 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-12 14:24:59,162 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-12 14:24:59,162 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-12 14:25:00,569 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-12 14:25:00,569 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-12 14:25:00,569 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-12 14:25:00,569 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-12 14:25:00,569 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-12 14:25:00,990 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-12 14:25:01,381 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-12 14:25:01,381 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-12 14:25:01,381 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-12 14:25:01,381 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-12 14:25:01,381 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-12 14:25:01,662 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-12 14:25:01,662 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-12 14:25:02,006 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-12 14:25:02,006 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:25:51,641 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.7232329078831854 Val loss: 3.7008080334789986 Train ndcg_5 0.21066412329673767 Train ndcg_10 0.2410522997379303 Train lndcg_5 0.22210626304149628 Train lndcg_10 0.251394659280777 Train fndcg_10 0.3846587538719177 Train georisk_10 0.3317086398601532 Val ndcg_5 0.16154715418815613 Val ndcg_10 0.20992103219032288 Val lndcg_5 0.17027965188026428 Val lndcg_10 0.21717941761016846 Val fndcg_10 0.3469729423522949 Val georisk_10 0.3010061979293823
2021-07-12 14:25:51,641 - allrank.utils.ltr_logging - INFO - Current:0.20992103219032288 Best:0.0
2021-07-12 14:25:54,454 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023, 'fndcg_10': 0.3556586923240422} 
2021-07-12 14:25:54,454 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:26:41,272 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-12 14:26:41,272 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'fndcg': [5,
                                   10],
                         'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'ndcg': [5,
                                  10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-12 14:26:41,272 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-12 14:26:41,287 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-12 14:26:41,287 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-12 14:26:43,162 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-12 14:26:43,178 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-12 14:26:43,178 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-12 14:26:43,178 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-12 14:26:43,178 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-12 14:26:43,600 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-12 14:26:44,037 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:27:32,528 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.7232329078831854 Val loss: 3.7008080334789986 Train ndcg_5 0.21066412329673767 Train ndcg_10 0.2410522997379303 Train lndcg_5 0.22210626304149628 Train lndcg_10 0.251394659280777 Train fndcg_5 0.35642680525779724 Train fndcg_10 0.3846587538719177 Train georisk_10 0.3317086398601532 Val ndcg_5 0.16154715418815613 Val ndcg_10 0.20992103219032288 Val lndcg_5 0.17027965188026428 Val lndcg_10 0.21717941761016846 Val fndcg_5 0.30007311701774597 Val fndcg_10 0.3469729423522949 Val georisk_10 0.3010061979293823
2021-07-12 14:27:32,528 - allrank.utils.ltr_logging - INFO - Current:0.20992103219032288 Best:0.0
2021-07-12 14:27:34,903 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023, 'fndcg_5': 0.3268999412724307, 'fndcg_10': 0.3556586923240421} 
2021-07-12 14:27:34,903 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:28:20,984 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.715596098698229 Val loss: 3.700421880480111 Train ndcg_5 0.20660892128944397 Train ndcg_10 0.23594968020915985 Train lndcg_5 0.21083815395832062 Train lndcg_10 0.2434339076280594 Train fndcg_5 0.3595448434352875 Train fndcg_10 0.3912979066371918 Train georisk_10 0.3278791606426239 Val ndcg_5 0.18175679445266724 Val ndcg_10 0.2246190458536148 Val lndcg_5 0.19065487384796143 Val lndcg_10 0.23228305578231812 Val fndcg_5 0.32044845819473267 Val fndcg_10 0.36207669973373413 Val georisk_10 0.30986112356185913
2021-07-12 14:28:20,987 - allrank.utils.ltr_logging - INFO - Current:0.2246190458536148 Best:0.20992103219032288
2021-07-12 14:28:23,082 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19456194332744345, 'ndcg_10': 0.2229351171228868, 'lndcg_5': 0.20420198434433007, 'lndcg_10': 0.23162900510713363, 'fndcg_5': 0.34110674624909193, 'fndcg_10': 0.36853376701189555} 
2021-07-12 14:28:23,082 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.7232329078831854, 3.715596098698229]
2021-07-12 14:28:23,082 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.7008080334789986, 3.700421880480111]
2021-07-12 14:28:23,082 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.21066412, 'ndcg_10': 0.2410523, 'lndcg_5': 0.22210626, 'lndcg_10': 0.25139466, 'fndcg_5': 0.3564268, 'fndcg_10': 0.38465875, 'georisk_10': 0.33170864}, {'ndcg_5': 0.20660892, 'ndcg_10': 0.23594968, 'lndcg_5': 0.21083815, 'lndcg_10': 0.24343391, 'fndcg_5': 0.35954484, 'fndcg_10': 0.3912979, 'georisk_10': 0.32787916}]
2021-07-12 14:28:23,083 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.16154715, 'ndcg_10': 0.20992103, 'lndcg_5': 0.17027965, 'lndcg_10': 0.21717942, 'fndcg_5': 0.30007312, 'fndcg_10': 0.34697294, 'georisk_10': 0.3010062}, {'ndcg_5': 0.1817568, 'ndcg_10': 0.22461905, 'lndcg_5': 0.19065487, 'lndcg_10': 0.23228306, 'fndcg_5': 0.32044846, 'fndcg_10': 0.3620767, 'georisk_10': 0.30986112}]
2021-07-12 14:28:23,083 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023, 'fndcg_5': 0.3268999412724307, 'fndcg_10': 0.3556586923240421}, {'ndcg_5': 0.19456194332744345, 'ndcg_10': 0.2229351171228868, 'lndcg_5': 0.20420198434433007, 'lndcg_10': 0.23162900510713363, 'fndcg_5': 0.34110674624909193, 'fndcg_10': 0.36853376701189555}]
2021-07-12 14:29:29,778 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-07-12 14:29:29,779 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='listNet', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-07-12 14:29:29,779 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-07-12 14:29:29,792 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-07-12 14:29:29,792 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-07-12 14:29:31,048 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-07-12 14:29:31,058 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-07-12 14:29:31,058 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-07-12 14:29:31,060 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-07-12 14:29:31,060 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-07-12 14:29:31,477 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-07-12 14:29:31,481 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-07-12 14:29:31,481 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-07-12 14:29:31,481 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-07-12 14:29:31,482 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-07-12 14:29:31,482 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-07-12 14:29:31,927 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-07-12 14:29:31,930 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-07-12 14:29:31,930 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-07-12 14:29:31,931 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-07-12 14:29:31,931 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-07-12 14:29:31,932 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-07-12 14:29:31,933 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-07-12 14:29:31,938 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-07-12 14:29:31,938 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:30:20,878 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 3.7232329078831854 Val loss: 3.7008080334789986 Train ndcg_5 0.21066412329673767 Train ndcg_10 0.2410522997379303 Train lndcg_5 0.22210626304149628 Train lndcg_10 0.251394659280777 Train lndcg1_5 0.35642680525779724 Train lndcg1_10 0.3846587538719177 Train ndcg1_5 0.3507481813430786 Train ndcg1_10 0.3814569413661957 Train georisk_10 0.3183727562427521 Val ndcg_5 0.16154715418815613 Val ndcg_10 0.20992103219032288 Val lndcg_5 0.17027965188026428 Val lndcg_10 0.21717941761016846 Val lndcg1_5 0.30007311701774597 Val lndcg1_10 0.3469729423522949 Val ndcg1_5 0.2913406193256378 Val ndcg1_10 0.33971449732780457 Val georisk_10 0.3010061979293823
2021-07-12 14:30:20,878 - allrank.utils.ltr_logging - INFO - Current:0.20992103219032288 Best:0.0
2021-07-12 14:30:23,402 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023, 'lndcg1_5': 0.3268999412724307, 'lndcg1_10': 0.3556586923240421, 'ndcg1_5': 0.3178352974765567, 'ndcg1_10': 0.347300328662198} 
2021-07-12 14:30:23,402 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-07-12 14:31:14,542 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 3.7154556544481125 Val loss: 3.700422302459897 Train ndcg_5 0.20615993440151215 Train ndcg_10 0.23472729325294495 Train lndcg_5 0.21987122297286987 Train lndcg_10 0.25066205859184265 Train lndcg1_5 0.3590131103992462 Train lndcg1_10 0.39142000675201416 Train ndcg1_5 0.35721349716186523 Train ndcg1_10 0.38557764887809753 Train georisk_10 0.330903559923172 Val ndcg_5 0.18048524856567383 Val ndcg_10 0.22446918487548828 Val lndcg_5 0.1893308311700821 Val lndcg_10 0.23225794732570648 Val lndcg1_5 0.3191244602203369 Val lndcg1_10 0.3620515465736389 Val ndcg1_5 0.3102787137031555 Val ndcg1_10 0.3542628586292267 Val georisk_10 0.30976390838623047
2021-07-12 14:31:14,545 - allrank.utils.ltr_logging - INFO - Current:0.22446918487548828 Best:0.20992103219032288
2021-07-12 14:31:17,162 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.1947954813366426, 'ndcg_10': 0.22371320333065073, 'lndcg_5': 0.20427892277690055, 'lndcg_10': 0.23236955248770522, 'lndcg1_5': 0.34118368468166244, 'lndcg1_10': 0.36927431439246716, 'ndcg1_5': 0.3317002432414045, 'ndcg1_10': 0.3606179652354126} 
2021-07-12 14:31:17,162 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[3.7232329078831854, 3.7154556544481125]
2021-07-12 14:31:17,162 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[3.7008080334789986, 3.700422302459897]
2021-07-12 14:31:17,162 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.21066412, 'ndcg_10': 0.2410523, 'lndcg_5': 0.22210626, 'lndcg_10': 0.25139466, 'lndcg1_5': 0.3564268, 'lndcg1_10': 0.38465875, 'ndcg1_5': 0.35074818, 'ndcg1_10': 0.38145694, 'georisk_10': 0.31837276}, {'ndcg_5': 0.20615993, 'ndcg_10': 0.2347273, 'lndcg_5': 0.21987122, 'lndcg_10': 0.25066206, 'lndcg1_5': 0.3590131, 'lndcg1_10': 0.39142, 'ndcg1_5': 0.3572135, 'ndcg1_10': 0.38557765, 'georisk_10': 0.33090356}]
2021-07-12 14:31:17,163 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.16154715, 'ndcg_10': 0.20992103, 'lndcg_5': 0.17027965, 'lndcg_10': 0.21717942, 'lndcg1_5': 0.30007312, 'lndcg1_10': 0.34697294, 'ndcg1_5': 0.29134062, 'ndcg1_10': 0.3397145, 'georisk_10': 0.3010062}, {'ndcg_5': 0.18048525, 'ndcg_10': 0.22446918, 'lndcg_5': 0.18933083, 'lndcg_10': 0.23225795, 'lndcg1_5': 0.31912446, 'lndcg1_10': 0.36205155, 'ndcg1_5': 0.3102787, 'ndcg1_10': 0.35426286, 'georisk_10': 0.3097639}]
2021-07-12 14:31:17,163 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.1809305355717948, 'ndcg_10': 0.21039556675743606, 'lndcg_5': 0.1899951793676688, 'lndcg_10': 0.21875393041928023, 'lndcg1_5': 0.3268999412724307, 'lndcg1_10': 0.3556586923240421, 'ndcg1_5': 0.3178352974765567, 'ndcg1_10': 0.347300328662198}, {'ndcg_5': 0.1947954813366426, 'ndcg_10': 0.22371320333065073, 'lndcg_5': 0.20427892277690055, 'lndcg_10': 0.23236955248770522, 'lndcg1_5': 0.34118368468166244, 'lndcg1_10': 0.36927431439246716, 'ndcg1_5': 0.3317002432414045, 'ndcg1_10': 0.3606179652354126}]
2021-10-21 11:29:02,980 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 11:29:02,990 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='lambdaLossmulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 11:29:02,990 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 11:29:03,014 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 11:29:03,014 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 11:29:04,361 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 11:29:04,372 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 11:29:04,372 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 11:29:04,373 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 11:29:04,373 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 11:29:04,779 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 11:29:04,796 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 11:29:04,796 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 11:29:04,797 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 11:29:04,797 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 11:29:04,797 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 11:29:05,198 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 11:29:05,201 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 11:29:05,201 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 11:29:05,202 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 11:29:05,202 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 11:29:05,761 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 11:29:05,783 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 11:29:06,216 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 11:29:06,216 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:31:03,216 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 18457.56908243455 Val loss: 33359.09736241704 Train ndcg_5 0.21170373260974884 Train ndcg_10 0.24110573530197144 Train lndcg_5 0.22974884510040283 Train lndcg_10 0.26036161184310913 Train lndcg1_5 0.3641565442085266 Train lndcg1_10 0.39544838666915894 Train ndcg1_5 0.35744237899780273 Train ndcg1_10 0.3907747268676758 Train georisk_10 0.31997206807136536 Val ndcg_5 0.18343210220336914 Val ndcg_10 0.22567126154899597 Val lndcg_5 0.19271643459796906 Val lndcg_10 0.233242005109787 Val lndcg1_5 0.32250988483428955 Val lndcg1_10 0.36303552985191345 Val ndcg1_5 0.31322550773620605 Val ndcg1_10 0.3554648160934448 Val georisk_10 0.31039875745773315
2021-10-21 11:31:03,217 - allrank.utils.ltr_logging - INFO - Current:0.22567126154899597 Best:0.0
2021-10-21 11:31:05,886 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.18302256362078748, 'ndcg_10': 0.2127715303648284, 'lndcg_5': 0.19257232120405926, 'lndcg_10': 0.22119233978300226, 'lndcg1_5': 0.32947708310882123, 'lndcg1_10': 0.35809710168776415, 'ndcg1_5': 0.31992732552554937, 'ndcg1_10': 0.3496762922695903} 
2021-10-21 11:31:05,887 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:32:38,738 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 11:32:38,741 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='lambdaLossmulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 11:32:38,742 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 11:32:38,763 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 11:32:38,763 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 11:32:40,306 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 11:32:40,326 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 11:32:40,326 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 11:32:40,328 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 11:32:40,328 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 11:32:40,737 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 11:32:40,743 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 11:32:40,743 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 11:32:40,744 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 11:32:40,744 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 11:32:40,744 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 11:32:41,151 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 11:32:41,157 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 11:32:41,157 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 11:32:41,158 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 11:32:41,158 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 11:32:41,160 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 11:32:41,160 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 11:32:41,178 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 11:32:41,178 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:56:36,410 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 11:56:36,412 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='ordinalmulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 2}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 11:56:36,412 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 11:56:36,422 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 11:56:36,423 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 11:56:37,634 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 11:56:37,643 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 11:56:37,643 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 11:56:37,645 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 11:56:37,645 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 11:56:38,172 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 11:56:38,179 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 11:56:38,179 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 11:56:38,181 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 11:56:38,182 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 11:56:38,182 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 11:56:38,649 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 11:56:38,652 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 11:56:38,653 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 11:56:38,653 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 11:56:38,653 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 11:56:38,654 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 11:56:38,655 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 11:56:38,660 - allrank.utils.ltr_logging - INFO - Model has 29846 trainable parameters
2021-10-21 11:56:38,660 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:57:10,158 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 11:57:10,159 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='ordinalmulti', args={'n': 2}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 2}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 11:57:10,159 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 11:57:10,171 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 11:57:10,171 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 11:57:11,388 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 11:57:11,398 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 11:57:11,398 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 11:57:11,399 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 11:57:11,400 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 11:57:11,804 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 11:57:11,807 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 11:57:11,807 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 11:57:11,808 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 11:57:11,808 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 11:57:11,808 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 11:57:12,207 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 11:57:12,210 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 11:57:12,210 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 11:57:12,211 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 11:57:12,211 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 11:57:12,212 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 11:57:12,213 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 11:57:12,219 - allrank.utils.ltr_logging - INFO - Model has 29846 trainable parameters
2021-10-21 11:57:12,219 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:58:04,037 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 6.918190419263661 Val loss: 5.2194964034719105 Train ndcg_5 0.21598057448863983 Train ndcg_10 0.24555604159832 Train lndcg_5 0.23030458390712738 Train lndcg_10 0.25731387734413147 Train lndcg1_5 0.37298187613487244 Train lndcg1_10 0.40080684423446655 Train ndcg1_5 0.3519270122051239 Train ndcg1_10 0.3846793472766876 Train georisk_10 0.32651540637016296 Val ndcg_5 0.16944214701652527 Val ndcg_10 0.20880331099033356 Val lndcg_5 0.18015830218791962 Val lndcg_10 0.217417910695076 Val lndcg1_5 0.30995187163352966 Val lndcg1_10 0.34721148014068604 Val ndcg1_5 0.2992354929447174 Val ndcg1_10 0.3385968804359436 Val georisk_10 0.29621297121047974
2021-10-21 11:58:04,037 - allrank.utils.ltr_logging - INFO - Current:0.20880331099033356 Best:0.0
2021-10-21 11:58:06,635 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19866760160356742, 'ndcg_10': 0.2270600000657896, 'lndcg_5': 0.20790311158048103, 'lndcg_10': 0.23601715609314258, 'lndcg1_5': 0.34480787348524294, 'lndcg1_10': 0.3729219179979045, 'ndcg1_5': 0.3355723635083293, 'ndcg1_10': 0.3639647619705515} 
2021-10-21 11:58:06,636 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 11:59:42,992 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 11:59:42,993 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScore', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 11:59:42,993 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 11:59:43,004 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 11:59:43,004 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 11:59:44,206 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 11:59:44,216 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 11:59:44,216 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 11:59:44,218 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 11:59:44,218 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 11:59:44,603 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 11:59:44,607 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 11:59:44,607 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 11:59:44,607 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 11:59:44,608 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 11:59:44,608 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 11:59:44,990 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 11:59:44,994 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 11:59:44,994 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 11:59:44,995 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 11:59:44,995 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 11:59:44,996 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 11:59:44,996 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 11:59:45,002 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 11:59:45,002 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:01:03,833 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:01:03,836 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScore', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:01:03,837 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:01:03,847 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:01:03,848 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:01:05,032 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:01:05,050 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:01:05,050 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:01:05,052 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:01:05,052 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:01:05,440 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:01:05,447 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:01:05,447 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:01:05,448 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:01:05,448 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:01:05,448 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:01:05,836 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:01:05,842 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:01:05,842 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:01:05,843 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:01:05,843 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:01:05,845 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 12:01:05,845 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:01:05,863 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:01:05,864 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:04:46,643 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:04:46,645 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=100, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScore', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:04:46,646 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:04:46,657 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:04:46,657 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:04:47,846 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:04:47,865 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:04:47,865 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:04:47,867 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:04:47,867 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:04:48,254 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:04:48,260 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:04:48,261 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:04:48,261 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:04:48,262 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:04:48,262 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:04:48,699 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:04:48,705 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:04:48,705 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:04:48,706 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:04:48,706 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:04:48,707 - allrank.utils.ltr_logging - INFO - total batch size is 100
2021-10-21 12:04:48,708 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:04:48,726 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:04:48,727 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:07:07,324 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:07:07,326 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScore', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:07:07,326 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:07:07,337 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:07:07,337 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:07:08,621 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:07:08,640 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:07:08,640 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:07:08,642 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:07:08,643 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:07:09,067 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:07:09,074 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:07:09,075 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:07:09,076 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:07:09,076 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:07:09,076 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:07:09,507 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:07:09,514 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:07:09,515 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:07:09,515 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:07:09,516 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:07:09,517 - allrank.utils.ltr_logging - INFO - total batch size is 20
2021-10-21 12:07:09,517 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:07:09,536 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:07:09,536 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:08:49,599 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:08:49,600 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScoreMean', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:08:49,600 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:08:49,610 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:08:49,611 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:08:50,801 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:08:50,812 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:08:50,812 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:08:50,814 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:08:50,814 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:08:51,215 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:08:51,218 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:08:51,218 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:08:51,219 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:08:51,219 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:08:51,219 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:08:51,613 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:08:51,616 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:08:51,616 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:08:51,617 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:08:51,617 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:08:51,618 - allrank.utils.ltr_logging - INFO - total batch size is 20
2021-10-21 12:08:51,618 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:08:51,625 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:08:51,625 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:09:52,432 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: -0.9852102157992247 Val loss: -0.9851680019963808 Train ndcg_5 0.20131027698516846 Train ndcg_10 0.23103618621826172 Train lndcg_5 0.21774353086948395 Train lndcg_10 0.24702495336532593 Train lndcg1_5 0.35973066091537476 Train lndcg1_10 0.3968372941017151 Train ndcg1_5 0.34826138615608215 Train ndcg1_10 0.37998804450035095 Train georisk_10 0.32616010308265686 Val ndcg_5 0.18727664649486542 Val ndcg_10 0.22898706793785095 Val lndcg_5 0.19609344005584717 Val lndcg_10 0.2366172820329666 Val lndcg1_5 0.325886994600296 Val lndcg1_10 0.3664108216762543 Val ndcg1_5 0.3170701265335083 Val ndcg1_10 0.3587805926799774 Val georisk_10 0.3096446990966797
2021-10-21 12:09:52,433 - allrank.utils.ltr_logging - INFO - Current:0.22898706793785095 Best:0.0
2021-10-21 12:09:54,873 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19751620658948396, 'ndcg_10': 0.23010088540089663, 'lndcg_5': 0.20680517398491347, 'lndcg_10': 0.2383892166613873, 'lndcg1_5': 0.34370993588967536, 'lndcg1_10': 0.3752939785661492, 'ndcg1_5': 0.33442096849424585, 'ndcg1_10': 0.36700564730565854} 
2021-10-21 12:09:54,873 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:11:32,124 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:11:32,125 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskCorrScore', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:11:32,126 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:11:32,136 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:11:32,136 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:11:33,313 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:11:33,322 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:11:33,323 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:11:33,324 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:11:33,325 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:11:33,710 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:11:33,714 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:11:33,714 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:11:33,714 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:11:33,715 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:11:33,715 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:11:34,098 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:11:34,102 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:11:34,102 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:11:34,102 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:11:34,103 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:11:34,103 - allrank.utils.ltr_logging - INFO - total batch size is 20
2021-10-21 12:11:34,104 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:11:34,110 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:11:34,110 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:12:54,660 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.0022383872034978727 Val loss: 0.003031283177457376 Train ndcg_5 0.20186516642570496 Train ndcg_10 0.23087158799171448 Train lndcg_5 0.22031298279762268 Train lndcg_10 0.251167893409729 Train lndcg1_5 0.35926929116249084 Train lndcg1_10 0.3941180109977722 Train ndcg1_5 0.3480098843574524 Train ndcg1_10 0.38023367524147034 Train georisk_10 0.32575684785842896 Val ndcg_5 0.1769983470439911 Val ndcg_10 0.22358457744121552 Val lndcg_5 0.18628035485744476 Val lndcg_10 0.23134464025497437 Val lndcg1_5 0.3160739541053772 Val lndcg1_10 0.3611381947994232 Val ndcg1_5 0.30679187178611755 Val ndcg1_10 0.3533780574798584 Val georisk_10 0.30987703800201416
2021-10-21 12:12:54,660 - allrank.utils.ltr_logging - INFO - Current:0.22358457744121552 Best:0.0
2021-10-21 12:12:57,178 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.19584144717727886, 'ndcg_10': 0.22261822462786635, 'lndcg_5': 0.20525533560813364, 'lndcg_10': 0.23120350793431263, 'lndcg1_5': 0.34216009751289556, 'lndcg1_10': 0.3681082698390745, 'ndcg1_5': 0.3327462090820408, 'ndcg1_10': 0.35952298653262826} 
2021-10-21 12:12:57,179 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:15:38,892 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:15:38,893 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='CorrScoremulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:15:38,893 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:15:38,905 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:15:38,905 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:15:41,017 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:15:41,028 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:15:41,028 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:15:41,030 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:15:41,030 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:15:41,470 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:15:41,476 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:15:41,476 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:15:41,477 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:15:41,477 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:15:41,477 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:15:42,224 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:15:42,231 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:15:42,232 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:15:42,233 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:15:42,233 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:15:42,236 - allrank.utils.ltr_logging - INFO - total batch size is 20
2021-10-21 12:15:42,236 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:15:42,247 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:15:42,247 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:17:13,738 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: -4.926408636886461 Val loss: -4.9258451827507805 Train ndcg_5 0.20194780826568604 Train ndcg_10 0.23184601962566376 Train lndcg_5 0.21990430355072021 Train lndcg_10 0.25046974420547485 Train lndcg1_5 0.3582950234413147 Train lndcg1_10 0.3957385718822479 Train ndcg1_5 0.3510618805885315 Train ndcg1_10 0.3828699290752411 Train georisk_10 0.3269556164741516 Val ndcg_5 0.19442687928676605 Val ndcg_10 0.2393990308046341 Val lndcg_5 0.2033863514661789 Val lndcg_10 0.24680443108081818 Val lndcg1_5 0.33317992091178894 Val lndcg1_10 0.3765980005264282 Val ndcg1_5 0.32422032952308655 Val ndcg1_10 0.36919257044792175 Val georisk_10 0.3162630796432495
2021-10-21 12:17:13,738 - allrank.utils.ltr_logging - INFO - Current:0.2393990308046341 Best:0.0
2021-10-21 12:17:16,853 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.21192555322167148, 'ndcg_10': 0.24355189820055723, 'lndcg_5': 0.22125080502513972, 'lndcg_10': 0.25187533577663135, 'lndcg1_5': 0.3581555669299017, 'lndcg1_10': 0.3887800976813934, 'ndcg1_5': 0.34883031512643337, 'ndcg1_10': 0.38045666010531914} 
2021-10-21 12:17:16,854 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:19:40,148 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id4', tensorboard_output_path='results-new/tb_evals\\single\\id4', config_path='localtemp_config.json')
2021-10-21 12:19:40,149 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='spearmanLossmulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=64, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2021-10-21 12:19:40,149 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id4\used_config.json"
2021-10-21 12:19:40,159 - allrank.utils.ltr_logging - INFO - exit_code = 0
2021-10-21 12:19:40,160 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.train.txt
2021-10-21 12:19:41,328 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.train.txt'> and got x shape (42158, 46), y shape (42158,) and query_ids shape (42158,)
2021-10-21 12:19:41,338 - allrank.utils.ltr_logging - INFO - loaded dataset with 1017 queries
2021-10-21 12:19:41,338 - allrank.utils.ltr_logging - INFO - longest query had 147 documents
2021-10-21 12:19:41,340 - allrank.utils.ltr_logging - INFO - train DS shape: [1017, 147, 46]
2021-10-21 12:19:41,340 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.vali.txt
2021-10-21 12:19:41,723 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.vali.txt'> and got x shape (13813, 46), y shape (13813,) and query_ids shape (13813,)
2021-10-21 12:19:41,727 - allrank.utils.ltr_logging - INFO - loaded dataset with 339 queries
2021-10-21 12:19:41,727 - allrank.utils.ltr_logging - INFO - longest query had 88 documents
2021-10-21 12:19:41,727 - allrank.utils.ltr_logging - INFO - vali DS shape: [339, 88, 46]
2021-10-21 12:19:41,728 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 88
2021-10-21 12:19:41,728 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\MQ2007\MQ2007\Fold1\Norm.test.txt
2021-10-21 12:19:42,114 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\MQ2007\\MQ2007\\Fold1\\Norm.test.txt'> and got x shape (13652, 46), y shape (13652,) and query_ids shape (13652,)
2021-10-21 12:19:42,117 - allrank.utils.ltr_logging - INFO - loaded dataset with 336 queries
2021-10-21 12:19:42,117 - allrank.utils.ltr_logging - INFO - longest query had 80 documents
2021-10-21 12:19:42,118 - allrank.utils.ltr_logging - INFO - test DS shape: [336, 80, 46]
2021-10-21 12:19:42,118 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 80
2021-10-21 12:19:42,119 - allrank.utils.ltr_logging - INFO - total batch size is 20
2021-10-21 12:19:42,119 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2021-10-21 12:19:42,126 - allrank.utils.ltr_logging - INFO - Model has 29799 trainable parameters
2021-10-21 12:19:42,126 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2021-10-21 12:21:28,904 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: -2.922687657111514 Val loss: -3.068600302952229 Train ndcg_5 0.20472413301467896 Train ndcg_10 0.2343382090330124 Train lndcg_5 0.2246762067079544 Train lndcg_10 0.2525342106819153 Train lndcg1_5 0.36243578791618347 Train lndcg1_10 0.3995681405067444 Train ndcg1_5 0.35485291481018066 Train ndcg1_10 0.3859758973121643 Train georisk_10 0.3308221399784088 Val ndcg_5 0.21895992755889893 Val ndcg_10 0.2583490014076233 Val lndcg_5 0.22852255403995514 Val lndcg_10 0.26623865962028503 Val lndcg1_5 0.35831618309020996 Val lndcg1_10 0.3960321843624115 Val ndcg1_5 0.34875357151031494 Val ndcg1_10 0.38814255595207214 Val georisk_10 0.32743313908576965
2021-10-21 12:21:28,905 - allrank.utils.ltr_logging - INFO - Current:0.2583490014076233 Best:0.0
2021-10-21 12:21:31,465 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.23114306745125995, 'ndcg_10': 0.2589800941301122, 'lndcg_5': 0.24172721460269903, 'lndcg_10': 0.2683791335313192, 'lndcg1_5': 0.37863197650746094, 'lndcg1_10': 0.40528389543608107, 'ndcg1_5': 0.36804782935602187, 'ndcg1_10': 0.3958848560348741} 
2021-10-21 12:21:31,465 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
