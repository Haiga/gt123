2023-08-09 14:47:06,952 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\id-newyahoo', tensorboard_output_path='results-new/tb_evals\\single\\id-newyahoo', config_path='localtemp_config.json')
2023-08-09 14:47:06,953 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\yahoo-c14\\l2r\\usado-risk-loss', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='spearmanLossmulti', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=1, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-09 14:47:06,954 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\id-newyahoo\used_config.json"
2023-08-09 14:47:06,971 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-09 14:47:06,971 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\yahoo-c14\l2r\usado-risk-loss\Norm.train.txt
2023-08-09 14:47:09,775 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\yahoo-c14\\l2r\\usado-risk-loss\\Norm.train.txt'> and got x shape (19515, 699), y shape (19515,) and query_ids shape (19515,)
2023-08-09 14:47:09,808 - allrank.utils.ltr_logging - INFO - loaded dataset with 1337 queries
2023-08-09 14:47:09,808 - allrank.utils.ltr_logging - INFO - longest query had 117 documents
2023-08-09 14:47:09,812 - allrank.utils.ltr_logging - INFO - train DS shape: [1337, 117, 699]
2023-08-09 14:47:09,812 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\yahoo-c14\l2r\usado-risk-loss\Norm.vali.txt
2023-08-09 14:47:13,037 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\yahoo-c14\\l2r\\usado-risk-loss\\Norm.vali.txt'> and got x shape (24501, 699), y shape (24501,) and query_ids shape (24501,)
2023-08-09 14:47:13,075 - allrank.utils.ltr_logging - INFO - loaded dataset with 622 queries
2023-08-09 14:47:13,075 - allrank.utils.ltr_logging - INFO - longest query had 103 documents
2023-08-09 14:47:13,080 - allrank.utils.ltr_logging - INFO - vali DS shape: [622, 103, 699]
2023-08-09 14:47:13,080 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 103
2023-08-09 14:47:13,080 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\yahoo-c14\l2r\usado-risk-loss\Norm.test.txt
2023-08-09 14:47:36,444 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\yahoo-c14\\l2r\\usado-risk-loss\\Norm.test.txt'> and got x shape (165660, 699), y shape (165660,) and query_ids shape (165660,)
2023-08-09 14:47:36,776 - allrank.utils.ltr_logging - INFO - loaded dataset with 6983 queries
2023-08-09 14:47:36,776 - allrank.utils.ltr_logging - INFO - longest query had 129 documents
2023-08-09 14:47:36,808 - allrank.utils.ltr_logging - INFO - test DS shape: [6983, 129, 699]
2023-08-09 14:47:36,808 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 129
2023-08-09 14:47:36,809 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-09 14:47:36,809 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
