2023-08-11 09:06:53,991 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:06:53,991 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=50, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:06:53,991 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:06:54,131 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:06:54,131 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:06:56,850 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:06:56,866 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:06:56,866 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:06:56,881 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:06:56,881 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:06:57,381 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:06:57,397 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:06:57,397 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:06:57,397 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:06:57,397 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:06:57,397 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:06:57,975 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:06:57,975 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:06:57,975 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:06:57,975 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:06:57,991 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:06:58,194 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:06:58,194 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:06:58,600 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:06:58,600 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:16:06,936 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:16:06,938 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=50, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:16:06,938 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:16:06,957 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:16:06,957 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:16:07,672 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:16:07,682 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:16:07,682 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:16:07,685 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:16:07,685 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:16:08,112 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:16:08,119 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:16:08,119 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:16:08,124 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:16:08,124 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:16:08,124 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:16:08,607 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:16:08,613 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:16:08,613 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:16:08,615 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:16:08,615 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:16:08,617 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:16:08,617 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:16:08,624 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:16:08,624 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:16:16,523 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:16:16,524 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:16:17,478 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:16:17,478 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:16:23,235 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:16:23,237 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:16:37,084 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:16:37,085 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=2, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:16:37,085 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:16:37,153 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:16:37,153 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:16:37,780 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:16:37,790 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:16:37,790 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:16:37,793 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:16:37,793 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:16:38,194 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:16:38,200 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:16:38,200 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:16:38,202 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:16:38,202 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:16:38,202 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:16:38,601 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:16:38,607 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:16:38,607 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:16:38,609 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:16:38,609 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:16:38,611 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:16:38,611 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:16:38,618 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:16:38,618 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:16:44,138 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:16:44,139 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:16:44,990 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:16:44,990 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:16:50,514 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:16:50,515 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:16:51,378 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:16:51,378 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544]
2023-08-11 09:16:51,379 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084]
2023-08-11 09:16:51,379 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}]
2023-08-11 09:16:51,379 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}]
2023-08-11 09:16:51,379 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
2023-08-11 09:18:23,264 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:18:23,265 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:18:23,265 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:18:23,284 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:18:23,284 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:18:23,951 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:18:23,962 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:18:23,962 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:18:23,965 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:18:23,965 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:18:24,394 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:18:24,401 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:18:24,401 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:18:24,403 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:18:24,403 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:18:24,403 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:18:25,413 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:18:25,422 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:18:25,423 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:18:25,427 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:18:25,427 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:18:25,430 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:18:25,430 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:18:25,443 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:18:25,444 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:18:32,504 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:18:32,504 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:18:33,372 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:18:33,372 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:18:38,817 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:18:38,818 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:18:39,662 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:18:39,662 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:18:45,235 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 0.3230918248494466 Val loss: 0.37660881876945496 Train ndcg_5 0.04359465092420578 Train ndcg_10 0.08896253257989883 Train lndcg_5 0.057206206023693085 Train lndcg_10 0.06831731647253036 Train lndcg1_5 0.2130126655101776 Train lndcg1_10 0.2225576937198639 Train ndcg1_5 0.2195189893245697 Train ndcg1_10 0.2410280704498291 Train georisk_10 0.20703262090682983 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.0862501934170723 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.0862501934170723 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.18625019490718842 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.18625019490718842 Val georisk_10 0.20560337603092194
2023-08-11 09:18:45,236 - allrank.utils.ltr_logging - INFO - Current:0.0862501934170723 Best:0.08710332214832306
2023-08-11 09:18:46,159 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:18:51,635 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 0.32074829936027527 Val loss: 0.37653762102127075 Train ndcg_5 0.0 Train ndcg_10 0.0 Train lndcg_5 0.01946156844496727 Train lndcg_10 0.03818793594837189 Train lndcg1_5 0.24818700551986694 Train lndcg1_10 0.25767096877098083 Train ndcg1_5 0.22632065415382385 Train ndcg1_10 0.22632065415382385 Train georisk_10 0.1732131689786911 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:18:51,637 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:18:52,468 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:18:57,928 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 0.31855549414952594 Val loss: 0.37645286321640015 Train ndcg_5 0.0 Train ndcg_10 0.015150701627135277 Train lndcg_5 0.006736911833286285 Train lndcg_10 0.030529631301760674 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.20000000298023224 Train ndcg1_5 0.23088839650154114 Train ndcg1_10 0.2635745704174042 Train georisk_10 0.24469932913780212 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:18:57,929 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:18:58,748 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544, 0.3230918248494466, 0.32074829936027527, 0.31855549414952594]
2023-08-11 09:18:58,748 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084, 0.37660881876945496, 0.37653762102127075, 0.37645286321640015]
2023-08-11 09:18:58,748 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}, {'ndcg_5': 0.04359465, 'ndcg_10': 0.08896253, 'lndcg_5': 0.057206206, 'lndcg_10': 0.06831732, 'lndcg1_5': 0.21301267, 'lndcg1_10': 0.2225577, 'ndcg1_5': 0.21951899, 'ndcg1_10': 0.24102807, 'georisk_10': 0.20703262}, {'ndcg_5': 0.0, 'ndcg_10': 0.0, 'lndcg_5': 0.019461568, 'lndcg_10': 0.038187936, 'lndcg1_5': 0.248187, 'lndcg1_10': 0.25767097, 'ndcg1_5': 0.22632065, 'ndcg1_10': 0.22632065, 'georisk_10': 0.17321317}, {'ndcg_5': 0.0, 'ndcg_10': 0.015150702, 'lndcg_5': 0.006736912, 'lndcg_10': 0.030529631, 'lndcg1_5': 0.2, 'lndcg1_10': 0.2, 'ndcg1_5': 0.2308884, 'ndcg1_10': 0.26357457, 'georisk_10': 0.24469933}]
2023-08-11 09:18:58,748 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}, {'ndcg_5': 0.068326496, 'ndcg_10': 0.08625019, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08625019, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.1862502, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.1862502, 'georisk_10': 0.20560338}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}]
2023-08-11 09:18:58,748 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
2023-08-11 09:19:25,310 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:19:25,312 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:19:25,312 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:19:25,381 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:19:25,382 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:19:26,055 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:19:26,065 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:19:26,065 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:19:26,069 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:19:26,069 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:19:26,486 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:19:26,493 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:19:26,493 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:19:26,495 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:19:26,495 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:19:26,495 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:19:26,915 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:19:26,922 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:19:26,923 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:19:26,925 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:19:26,925 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:19:26,927 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:19:26,927 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:19:26,947 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:19:26,947 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:24:49,353 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:24:49,354 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:24:49,354 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:24:49,370 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:24:49,370 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:24:50,000 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:24:50,010 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:24:50,010 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:24:50,013 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:24:50,013 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:24:50,410 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:24:50,417 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:24:50,417 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:24:50,419 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:24:50,419 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:24:50,419 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:24:50,814 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:24:50,820 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:24:50,821 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:24:50,823 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:24:50,823 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:24:50,824 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:24:50,824 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:24:50,831 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:24:50,831 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:24:56,561 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:24:56,561 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:24:57,394 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:24:57,394 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:25:02,844 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:25:02,844 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:25:03,682 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:25:03,683 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:25:09,039 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 0.3230918248494466 Val loss: 0.37660881876945496 Train ndcg_5 0.04359465092420578 Train ndcg_10 0.08896253257989883 Train lndcg_5 0.057206206023693085 Train lndcg_10 0.06831731647253036 Train lndcg1_5 0.2130126655101776 Train lndcg1_10 0.2225576937198639 Train ndcg1_5 0.2195189893245697 Train ndcg1_10 0.2410280704498291 Train georisk_10 0.20703262090682983 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.0862501934170723 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.0862501934170723 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.18625019490718842 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.18625019490718842 Val georisk_10 0.20560337603092194
2023-08-11 09:25:09,041 - allrank.utils.ltr_logging - INFO - Current:0.0862501934170723 Best:0.08710332214832306
2023-08-11 09:25:09,893 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:25:15,314 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 0.32074829936027527 Val loss: 0.37653762102127075 Train ndcg_5 0.0 Train ndcg_10 0.0 Train lndcg_5 0.01946156844496727 Train lndcg_10 0.03818793594837189 Train lndcg1_5 0.24818700551986694 Train lndcg1_10 0.25767096877098083 Train ndcg1_5 0.22632065415382385 Train ndcg1_10 0.22632065415382385 Train georisk_10 0.1732131689786911 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:25:15,314 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:25:16,157 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:25:21,553 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 0.31855549414952594 Val loss: 0.37645286321640015 Train ndcg_5 0.0 Train ndcg_10 0.015150701627135277 Train lndcg_5 0.006736911833286285 Train lndcg_10 0.030529631301760674 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.20000000298023224 Train ndcg1_5 0.23088839650154114 Train ndcg1_10 0.2635745704174042 Train georisk_10 0.24469932913780212 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:25:21,553 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:25:22,392 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544, 0.3230918248494466, 0.32074829936027527, 0.31855549414952594]
2023-08-11 09:25:22,392 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084, 0.37660881876945496, 0.37653762102127075, 0.37645286321640015]
2023-08-11 09:25:22,392 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}, {'ndcg_5': 0.04359465, 'ndcg_10': 0.08896253, 'lndcg_5': 0.057206206, 'lndcg_10': 0.06831732, 'lndcg1_5': 0.21301267, 'lndcg1_10': 0.2225577, 'ndcg1_5': 0.21951899, 'ndcg1_10': 0.24102807, 'georisk_10': 0.20703262}, {'ndcg_5': 0.0, 'ndcg_10': 0.0, 'lndcg_5': 0.019461568, 'lndcg_10': 0.038187936, 'lndcg1_5': 0.248187, 'lndcg1_10': 0.25767097, 'ndcg1_5': 0.22632065, 'ndcg1_10': 0.22632065, 'georisk_10': 0.17321317}, {'ndcg_5': 0.0, 'ndcg_10': 0.015150702, 'lndcg_5': 0.006736912, 'lndcg_10': 0.030529631, 'lndcg1_5': 0.2, 'lndcg1_10': 0.2, 'ndcg1_5': 0.2308884, 'ndcg1_10': 0.26357457, 'georisk_10': 0.24469933}]
2023-08-11 09:25:22,392 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}, {'ndcg_5': 0.068326496, 'ndcg_10': 0.08625019, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08625019, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.1862502, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.1862502, 'georisk_10': 0.20560338}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}]
2023-08-11 09:25:22,392 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
2023-08-11 09:30:28,973 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:30:28,975 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:30:28,975 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:30:28,990 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:30:28,990 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:30:29,640 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:30:29,651 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:30:29,651 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:30:29,654 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:30:29,654 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:30:30,073 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:30:30,080 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:30:30,080 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:30:30,083 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:30:30,083 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:30:30,083 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:30:30,491 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:30:30,498 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:30:30,498 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:30:30,500 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:30:30,500 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:30:30,502 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:30:30,502 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:30:30,521 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:30:30,522 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:33:02,310 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:33:02,311 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:33:02,311 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:33:02,327 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:33:02,328 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:33:02,968 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:33:02,978 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:33:02,978 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:33:02,981 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:33:02,981 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:33:03,379 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:33:03,385 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:33:03,386 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:33:03,387 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:33:03,387 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:33:03,388 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:33:03,786 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:33:03,792 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:33:03,792 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:33:03,794 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:33:03,794 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:33:03,796 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:33:03,796 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:33:03,802 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:33:03,802 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:34:10,958 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:34:10,959 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:34:10,959 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:34:10,974 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:34:10,974 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:34:11,603 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:34:11,613 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:34:11,613 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:34:11,616 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:34:11,616 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:34:12,014 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:34:12,020 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:34:12,021 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:34:12,022 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:34:12,023 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:34:12,023 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:34:12,423 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:34:12,430 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:34:12,430 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:34:12,432 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:34:12,432 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:34:12,433 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:34:12,434 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:34:12,440 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:34:12,440 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:00,864 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:36:00,865 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:36:00,866 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:36:00,888 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:36:00,888 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:36:01,687 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:36:01,697 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:36:01,697 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:36:01,701 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:36:01,701 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:36:02,110 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:36:02,116 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:36:02,117 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:36:02,119 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:36:02,119 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:36:02,119 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:36:02,543 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:36:02,550 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:36:02,550 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:36:02,552 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:36:02,552 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:36:02,553 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:36:02,554 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:36:02,560 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:36:02,561 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:08,131 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:36:08,131 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:36:08,961 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:36:08,962 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:14,483 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:36:14,486 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:36:15,318 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:36:15,318 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:20,942 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 0.3230918248494466 Val loss: 0.37660881876945496 Train ndcg_5 0.04359465092420578 Train ndcg_10 0.08896253257989883 Train lndcg_5 0.057206206023693085 Train lndcg_10 0.06831731647253036 Train lndcg1_5 0.2130126655101776 Train lndcg1_10 0.2225576937198639 Train ndcg1_5 0.2195189893245697 Train ndcg1_10 0.2410280704498291 Train georisk_10 0.20703262090682983 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.0862501934170723 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.0862501934170723 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.18625019490718842 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.18625019490718842 Val georisk_10 0.20560337603092194
2023-08-11 09:36:20,945 - allrank.utils.ltr_logging - INFO - Current:0.0862501934170723 Best:0.08710332214832306
2023-08-11 09:36:21,789 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:27,243 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 0.32074829936027527 Val loss: 0.37653762102127075 Train ndcg_5 0.0 Train ndcg_10 0.0 Train lndcg_5 0.01946156844496727 Train lndcg_10 0.03818793594837189 Train lndcg1_5 0.24818700551986694 Train lndcg1_10 0.25767096877098083 Train ndcg1_5 0.22632065415382385 Train ndcg1_10 0.22632065415382385 Train georisk_10 0.1732131689786911 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:36:27,247 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:36:28,065 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:36:33,651 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 0.31855549414952594 Val loss: 0.37645286321640015 Train ndcg_5 0.0 Train ndcg_10 0.015150701627135277 Train lndcg_5 0.006736911833286285 Train lndcg_10 0.030529631301760674 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.20000000298023224 Train ndcg1_5 0.23088839650154114 Train ndcg1_10 0.2635745704174042 Train georisk_10 0.24469932913780212 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:36:33,656 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:36:34,493 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544, 0.3230918248494466, 0.32074829936027527, 0.31855549414952594]
2023-08-11 09:36:34,494 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084, 0.37660881876945496, 0.37653762102127075, 0.37645286321640015]
2023-08-11 09:36:34,494 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}, {'ndcg_5': 0.04359465, 'ndcg_10': 0.08896253, 'lndcg_5': 0.057206206, 'lndcg_10': 0.06831732, 'lndcg1_5': 0.21301267, 'lndcg1_10': 0.2225577, 'ndcg1_5': 0.21951899, 'ndcg1_10': 0.24102807, 'georisk_10': 0.20703262}, {'ndcg_5': 0.0, 'ndcg_10': 0.0, 'lndcg_5': 0.019461568, 'lndcg_10': 0.038187936, 'lndcg1_5': 0.248187, 'lndcg1_10': 0.25767097, 'ndcg1_5': 0.22632065, 'ndcg1_10': 0.22632065, 'georisk_10': 0.17321317}, {'ndcg_5': 0.0, 'ndcg_10': 0.015150702, 'lndcg_5': 0.006736912, 'lndcg_10': 0.030529631, 'lndcg1_5': 0.2, 'lndcg1_10': 0.2, 'ndcg1_5': 0.2308884, 'ndcg1_10': 0.26357457, 'georisk_10': 0.24469933}]
2023-08-11 09:36:34,494 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}, {'ndcg_5': 0.068326496, 'ndcg_10': 0.08625019, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08625019, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.1862502, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.1862502, 'georisk_10': 0.20560338}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}]
2023-08-11 09:36:34,494 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
2023-08-11 09:37:06,177 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:37:06,177 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:37:06,178 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:37:06,193 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:37:06,193 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:37:06,814 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:37:06,824 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:37:06,824 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:37:06,827 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:37:06,827 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:37:07,226 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:37:07,233 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:37:07,233 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:37:07,235 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:37:07,235 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:37:07,235 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:37:07,638 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:37:07,645 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:37:07,645 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:37:07,647 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:37:07,647 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:37:07,649 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:37:07,649 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:37:07,655 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:37:07,655 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:37:13,241 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:37:13,241 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:37:14,081 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:37:14,081 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:37:19,525 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:37:19,525 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:37:20,363 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:37:20,364 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:37:25,744 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 0.3230918248494466 Val loss: 0.37660881876945496 Train ndcg_5 0.04359465092420578 Train ndcg_10 0.08896253257989883 Train lndcg_5 0.057206206023693085 Train lndcg_10 0.06831731647253036 Train lndcg1_5 0.2130126655101776 Train lndcg1_10 0.2225576937198639 Train ndcg1_5 0.2195189893245697 Train ndcg1_10 0.2410280704498291 Train georisk_10 0.20703262090682983 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.0862501934170723 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.0862501934170723 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.18625019490718842 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.18625019490718842 Val georisk_10 0.20560337603092194
2023-08-11 09:37:25,747 - allrank.utils.ltr_logging - INFO - Current:0.0862501934170723 Best:0.08710332214832306
2023-08-11 09:37:26,572 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:37:32,110 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 0.32074829936027527 Val loss: 0.37653762102127075 Train ndcg_5 0.0 Train ndcg_10 0.0 Train lndcg_5 0.01946156844496727 Train lndcg_10 0.03818793594837189 Train lndcg1_5 0.24818700551986694 Train lndcg1_10 0.25767096877098083 Train ndcg1_5 0.22632065415382385 Train ndcg1_10 0.22632065415382385 Train georisk_10 0.1732131689786911 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:37:32,112 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:37:32,957 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:37:38,458 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 0.31855549414952594 Val loss: 0.37645286321640015 Train ndcg_5 0.0 Train ndcg_10 0.015150701627135277 Train lndcg_5 0.006736911833286285 Train lndcg_10 0.030529631301760674 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.20000000298023224 Train ndcg1_5 0.23088839650154114 Train ndcg1_10 0.2635745704174042 Train georisk_10 0.24469932913780212 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:37:38,461 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:37:39,328 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544, 0.3230918248494466, 0.32074829936027527, 0.31855549414952594]
2023-08-11 09:37:39,328 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084, 0.37660881876945496, 0.37653762102127075, 0.37645286321640015]
2023-08-11 09:37:39,328 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}, {'ndcg_5': 0.04359465, 'ndcg_10': 0.08896253, 'lndcg_5': 0.057206206, 'lndcg_10': 0.06831732, 'lndcg1_5': 0.21301267, 'lndcg1_10': 0.2225577, 'ndcg1_5': 0.21951899, 'ndcg1_10': 0.24102807, 'georisk_10': 0.20703262}, {'ndcg_5': 0.0, 'ndcg_10': 0.0, 'lndcg_5': 0.019461568, 'lndcg_10': 0.038187936, 'lndcg1_5': 0.248187, 'lndcg1_10': 0.25767097, 'ndcg1_5': 0.22632065, 'ndcg1_10': 0.22632065, 'georisk_10': 0.17321317}, {'ndcg_5': 0.0, 'ndcg_10': 0.015150702, 'lndcg_5': 0.006736912, 'lndcg_10': 0.030529631, 'lndcg1_5': 0.2, 'lndcg1_10': 0.2, 'ndcg1_5': 0.2308884, 'ndcg1_10': 0.26357457, 'georisk_10': 0.24469933}]
2023-08-11 09:37:39,329 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}, {'ndcg_5': 0.068326496, 'ndcg_10': 0.08625019, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08625019, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.1862502, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.1862502, 'georisk_10': 0.20560338}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}]
2023-08-11 09:37:39,329 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
2023-08-11 09:38:39,600 - allrank.utils.ltr_logging - INFO - created paths container PathsContainer(local_base_output_path='results-new/', base_output_path='results-new/', output_dir='results-new/results\\analise-external2003', tensorboard_output_path='results-new/tb_evals\\single\\analise-external2003', config_path='localtemp_config.json')
2023-08-11 09:38:39,601 - allrank.utils.ltr_logging - INFO - Config:
 {'click_model': None,
 'data': DataConfig(path='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2', num_workers=0, batch_size=20, slate_length=100, validation_ds_role='vali'),
 'detect_anomaly': True,
 'expected_metrics': {'val': {'georisk_10': 0.0,
                              'lndcg_10': 0.0,
                              'lndcg_5': 0.0,
                              'ndcg_10': 0.0,
                              'ndcg_5': 0.0}},
 'loss': NameArgsConfig(name='geoRiskSpearmanLoss', args={}),
 'lr_scheduler': NameArgsConfig(name=None, args={'step_size': 800, 'gamma': 0.5}),
 'metrics': defaultdict(<class 'list'>,
                        {'georisk': [10],
                         'lndcg': [5,
                                   10],
                         'lndcg1': [5,
                                    10],
                         'ndcg': [5,
                                  10],
                         'ndcg1': [5,
                                   10]}),
 'model': ModelConfig(fc_model={}, transformer=TransformerConfig(N=2, d_ff=32, h=2, positional_encoding=None, dropout=0.3), post_model={'output_activation': 'Sigmoid', 'd_output': 1}),
 'optimizer': NameArgsConfig(name='Adam', args={'lr': 0.0001}),
 'training': TrainingConfig(epochs=5, gradient_clipping_norm=None, early_stopping_patience=100),
 'val_metric': 'ndcg_10'}
2023-08-11 09:38:39,601 - allrank.utils.ltr_logging - INFO - will execute copy "localtemp_config.json" "results-new/results\analise-external2003\used_config.json"
2023-08-11 09:38:39,616 - allrank.utils.ltr_logging - INFO - exit_code = 0
2023-08-11 09:38:39,616 - allrank.utils.ltr_logging - INFO - will load train data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.train.txt
2023-08-11 09:38:40,267 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.train.txt'> and got x shape (15750, 64), y shape (15750,) and query_ids shape (15750,)
2023-08-11 09:38:40,276 - allrank.utils.ltr_logging - INFO - loaded dataset with 30 queries
2023-08-11 09:38:40,276 - allrank.utils.ltr_logging - INFO - longest query had 525 documents
2023-08-11 09:38:40,279 - allrank.utils.ltr_logging - INFO - train DS shape: [30, 525, 64]
2023-08-11 09:38:40,280 - allrank.utils.ltr_logging - INFO - will load vali data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.vali.txt
2023-08-11 09:38:40,684 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.vali.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:38:40,691 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:38:40,691 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:38:40,693 - allrank.utils.ltr_logging - INFO - vali DS shape: [10, 1000, 64]
2023-08-11 09:38:40,693 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:38:40,693 - allrank.utils.ltr_logging - INFO - will load test data from D:\Colecoes\BD\2003_td_dataset-norm\Fold2\Norm.test.txt
2023-08-11 09:38:41,094 - allrank.utils.ltr_logging - INFO - loaded dataset from <_io.BufferedReader name='D:\\Colecoes\\BD\\2003_td_dataset-norm\\Fold2\\Norm.test.txt'> and got x shape (10000, 64), y shape (10000,) and query_ids shape (10000,)
2023-08-11 09:38:41,101 - allrank.utils.ltr_logging - INFO - loaded dataset with 10 queries
2023-08-11 09:38:41,101 - allrank.utils.ltr_logging - INFO - longest query had 1000 documents
2023-08-11 09:38:41,103 - allrank.utils.ltr_logging - INFO - test DS shape: [10, 1000, 64]
2023-08-11 09:38:41,103 - allrank.utils.ltr_logging - INFO - Will pad to the longest slate: 1000
2023-08-11 09:38:41,104 - allrank.utils.ltr_logging - INFO - total batch size is 20
2023-08-11 09:38:41,104 - allrank.utils.ltr_logging - INFO - Model training will execute on cpu
2023-08-11 09:38:41,111 - allrank.utils.ltr_logging - INFO - Model has 42369 trainable parameters
2023-08-11 09:38:41,111 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:38:46,594 - allrank.utils.ltr_logging - INFO - Epoch : 0 Train loss: 0.3149592677752177 Val loss: 0.37675103545188904 Train ndcg_5 0.01963200606405735 Train ndcg_10 0.01963200606405735 Train lndcg_5 0.03357625752687454 Train lndcg_10 0.03235766664147377 Train lndcg1_5 0.2079065889120102 Train lndcg1_10 0.21978016197681427 Train ndcg1_5 0.20560425519943237 Train ndcg1_10 0.24602070450782776 Train georisk_10 0.18101465702056885 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.08565802127122879 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.08565802127122879 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.1856580227613449 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.1856580227613449 Val georisk_10 0.2049928456544876
2023-08-11 09:38:46,594 - allrank.utils.ltr_logging - INFO - Current:0.08565802127122879 Best:0.0
2023-08-11 09:38:47,436 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232} 
2023-08-11 09:38:47,436 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:38:52,870 - allrank.utils.ltr_logging - INFO - Epoch : 1 Train loss: 0.3270922005176544 Val loss: 0.37666431069374084 Train ndcg_5 0.021694015711545944 Train ndcg_10 0.031337615102529526 Train lndcg_5 0.024200433865189552 Train lndcg_10 0.0641719251871109 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.21873314678668976 Train ndcg1_5 0.28014060854911804 Train ndcg1_10 0.3070007264614105 Train georisk_10 0.18877723813056946 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08710332214832306 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08710332214832306 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1871033012866974 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1871033012866974 Val georisk_10 0.206556499004364
2023-08-11 09:38:52,874 - allrank.utils.ltr_logging - INFO - Current:0.08710332214832306 Best:0.08565802127122879
2023-08-11 09:38:53,705 - allrank.utils.ltr_logging - INFO - MY-flag writted predictions - because model is best on validation. Test metrics: {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244} 
2023-08-11 09:38:53,706 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:38:59,256 - allrank.utils.ltr_logging - INFO - Epoch : 2 Train loss: 0.3230918248494466 Val loss: 0.37660881876945496 Train ndcg_5 0.04359465092420578 Train ndcg_10 0.08896253257989883 Train lndcg_5 0.057206206023693085 Train lndcg_10 0.06831731647253036 Train lndcg1_5 0.2130126655101776 Train lndcg1_10 0.2225576937198639 Train ndcg1_5 0.2195189893245697 Train ndcg1_10 0.2410280704498291 Train georisk_10 0.20703262090682983 Val ndcg_5 0.06832649558782578 Val ndcg_10 0.0862501934170723 Val lndcg_5 0.06832649558782578 Val lndcg_10 0.0862501934170723 Val lndcg1_5 0.1683264970779419 Val lndcg1_10 0.18625019490718842 Val ndcg1_5 0.1683264970779419 Val ndcg1_10 0.18625019490718842 Val georisk_10 0.20560337603092194
2023-08-11 09:38:59,259 - allrank.utils.ltr_logging - INFO - Current:0.0862501934170723 Best:0.08710332214832306
2023-08-11 09:39:00,095 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:39:05,547 - allrank.utils.ltr_logging - INFO - Epoch : 3 Train loss: 0.32074829936027527 Val loss: 0.37653762102127075 Train ndcg_5 0.0 Train ndcg_10 0.0 Train lndcg_5 0.01946156844496727 Train lndcg_10 0.03818793594837189 Train lndcg1_5 0.24818700551986694 Train lndcg1_10 0.25767096877098083 Train ndcg1_5 0.22632065415382385 Train ndcg1_10 0.22632065415382385 Train georisk_10 0.1732131689786911 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:39:05,550 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:39:06,387 - allrank.utils.ltr_logging - INFO - Current learning rate: 0.0001
2023-08-11 09:39:11,831 - allrank.utils.ltr_logging - INFO - Epoch : 4 Train loss: 0.31855549414952594 Val loss: 0.37645286321640015 Train ndcg_5 0.0 Train ndcg_10 0.015150701627135277 Train lndcg_5 0.006736911833286285 Train lndcg_10 0.030529631301760674 Train lndcg1_5 0.20000000298023224 Train lndcg1_10 0.20000000298023224 Train ndcg1_5 0.23088839650154114 Train ndcg1_10 0.2635745704174042 Train georisk_10 0.24469932913780212 Val ndcg_5 0.08144700527191162 Val ndcg_10 0.08072896301746368 Val lndcg_5 0.08144700527191162 Val lndcg_10 0.08072896301746368 Val lndcg1_5 0.18144699931144714 Val lndcg1_10 0.1807289719581604 Val ndcg1_5 0.18144699931144714 Val ndcg1_10 0.1807289719581604 Val georisk_10 0.1991138607263565
2023-08-11 09:39:11,831 - allrank.utils.ltr_logging - INFO - Current:0.08072896301746368 Best:0.08710332214832306
2023-08-11 09:39:12,722 - allrank.utils.ltr_logging - INFO - Ending execution. Train Losses:
[0.3149592677752177, 0.3270922005176544, 0.3230918248494466, 0.32074829936027527, 0.31855549414952594]
2023-08-11 09:39:12,722 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Losses (not used to train):
[0.37675103545188904, 0.37666431069374084, 0.37660881876945496, 0.37653762102127075, 0.37645286321640015]
2023-08-11 09:39:12,722 - allrank.utils.ltr_logging - INFO - Ending execution. Train Metrics Evolution:
[{'ndcg_5': 0.019632006, 'ndcg_10': 0.019632006, 'lndcg_5': 0.033576258, 'lndcg_10': 0.032357667, 'lndcg1_5': 0.20790659, 'lndcg1_10': 0.21978016, 'ndcg1_5': 0.20560426, 'ndcg1_10': 0.2460207, 'georisk_10': 0.18101466}, {'ndcg_5': 0.021694016, 'ndcg_10': 0.031337615, 'lndcg_5': 0.024200434, 'lndcg_10': 0.064171925, 'lndcg1_5': 0.2, 'lndcg1_10': 0.21873315, 'ndcg1_5': 0.2801406, 'ndcg1_10': 0.30700073, 'georisk_10': 0.18877724}, {'ndcg_5': 0.04359465, 'ndcg_10': 0.08896253, 'lndcg_5': 0.057206206, 'lndcg_10': 0.06831732, 'lndcg1_5': 0.21301267, 'lndcg1_10': 0.2225577, 'ndcg1_5': 0.21951899, 'ndcg1_10': 0.24102807, 'georisk_10': 0.20703262}, {'ndcg_5': 0.0, 'ndcg_10': 0.0, 'lndcg_5': 0.019461568, 'lndcg_10': 0.038187936, 'lndcg1_5': 0.248187, 'lndcg1_10': 0.25767097, 'ndcg1_5': 0.22632065, 'ndcg1_10': 0.22632065, 'georisk_10': 0.17321317}, {'ndcg_5': 0.0, 'ndcg_10': 0.015150702, 'lndcg_5': 0.006736912, 'lndcg_10': 0.030529631, 'lndcg1_5': 0.2, 'lndcg1_10': 0.2, 'ndcg1_5': 0.2308884, 'ndcg1_10': 0.26357457, 'georisk_10': 0.24469933}]
2023-08-11 09:39:12,722 - allrank.utils.ltr_logging - INFO - Ending execution. Validation Metrics Evolution:
[{'ndcg_5': 0.068326496, 'ndcg_10': 0.08565802, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08565802, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.18565802, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.18565802, 'georisk_10': 0.20499285}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08710332, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08710332, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.1871033, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.1871033, 'georisk_10': 0.2065565}, {'ndcg_5': 0.068326496, 'ndcg_10': 0.08625019, 'lndcg_5': 0.068326496, 'lndcg_10': 0.08625019, 'lndcg1_5': 0.1683265, 'lndcg1_10': 0.1862502, 'ndcg1_5': 0.1683265, 'ndcg1_10': 0.1862502, 'georisk_10': 0.20560338}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}, {'ndcg_5': 0.081447005, 'ndcg_10': 0.08072896, 'lndcg_5': 0.081447005, 'lndcg_10': 0.08072896, 'lndcg1_5': 0.181447, 'lndcg1_10': 0.18072897, 'ndcg1_5': 0.181447, 'ndcg1_10': 0.18072897, 'georisk_10': 0.19911386}]
2023-08-11 09:39:12,722 - allrank.utils.ltr_logging - INFO - Ending execution. Test Metrics Evolution:
[{'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.0239920894185232, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.0239920894185232, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.0239920894185232, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.0239920894185232}, {'ndcg_5': 0.0169580100938534, 'ndcg_10': 0.024890832670330244, 'lndcg_5': 0.0169580100938534, 'lndcg_10': 0.024890832670330244, 'lndcg1_5': 0.0169580100938534, 'lndcg1_10': 0.024890832670330244, 'ndcg1_5': 0.0169580100938534, 'ndcg1_10': 0.024890832670330244}]
